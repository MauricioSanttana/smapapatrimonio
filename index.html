<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- Content Security Policy -->
    <meta http-equiv="Content-Security-Policy" content="
        default-src 'self';
        script-src 'self' 'unsafe-inline' https://cdnjs.cloudflare.com;
        style-src 'self' 'unsafe-inline' https://fonts.googleapis.com;
        font-src 'self' https://fonts.gstatic.com;
        img-src 'self' data: https:;
        connect-src 'self';
    ">
    
    <title>Sistema Patrimonial SMAPA</title>
    <link rel="stylesheet" href="css/estilo.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>SISTEMA DE CONTROLE PATRIMONIAL</h1>
            <p class="subtitle">SECRETARIA MUNICIPAL DO MEIO AMBIENTE E PROTE√á√ÉO ANIMAL</p>
            <p class="subtitle">PREFEITURA MUNICIPAL DE MOGI DAS CRUZES - SP</p>
        </div>
        
        <div class="toolbar">
            <div class="filters">
                <input type="text" id="busca" placeholder="Buscar tombamento, descri√ß√£o, respons√°vel..." onkeyup="filtrarTabela()">
                <select id="categoria" onchange="filtrarTabela()">
                    <option value="">Todas categorias</option>
                    <option value="Equipamento TI">Equipamento TI</option>
                    <option value="Ve√≠culos">Ve√≠culos</option>
                    <option value="Mobili√°rio">Mobili√°rio</option>
                    <option value="Equipamentos M√©dicos">Equipamentos M√©dicos</option>
                    <option value="Eletrodom√©sticos">Eletrodom√©sticos</option>
                    <option value="Comunica√ß√£o">Comunica√ß√£o</option>
                    <option value="Audiovisual">Audiovisual</option>
                </select>
                <button onclick="abrirModalAdicionar()">‚ûï Novo Patrim√¥nio</button>
                <button onclick="exportarExcel()">üìä Excel</button>
                <button onclick="gerarRelatorio()">üìã Relat√≥rio</button>
                <button onclick="limparFiltros()">üîÑ Limpar</button>
            </div>
        </div>
        
        <div class="stats">
            <div class="stat-item">
                <span class="stat-number" id="totalItens">0</span>
                <span class="stat-label">Total Itens</span>
            </div>
            <div class="stat-item">
                <span class="stat-number" id="totalAtivos">0</span>
                <span class="stat-label">Ativos</span>
            </div>
            <div class="stat-item">
                <span class="stat-number" id="totalManutencao">0</span>
                <span class="stat-label">Manuten√ß√£o</span>
            </div>
            <div class="stat-item">
                <span class="stat-number" id="totalCategorias">0</span>
                <span class="stat-label">Categorias</span>
            </div>
        </div>
        
        <div class="table-container">
            <table id="tabelaPatrimonio">
                <thead>
                    <tr>
                        <th>Tombamento</th>
                        <th>Descri√ß√£o</th>
                        <th>Categoria</th>
                        <th>Data Aquisi√ß√£o</th>
                        <th>Setor</th>
                        <th>Respons√°vel</th>
                        <th>Localiza√ß√£o</th>
                        <th>Situa√ß√£o</th>
                        <th>Inclu√≠do em</th>
                        <th>A√ß√µes</th>
                    </tr>
                </thead>
                <tbody id="corpoTabela"></tbody>
            </table>
        </div>

        <div class="footer">
            <p>Sistema desenvolvido internamente pela SMAPA</p>
            <p>Vers√£o 2.0 - 2024 | Atualiza√ß√£o: <span id="dataAtualizacao"></span></p>
        </div>
    </div>

    <!-- Modal Adicionar/Editar -->
    <div id="modalPatrimonio" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitulo">Novo Patrim√¥nio</h2>
                <span class="close" onclick="fecharModal()">&times;</span>
            </div>
            <form id="formPatrimonio" onsubmit="salvarPatrimonio(event)">
                <div class="form-grid">
                    <div class="form-group">
                        <label>Tombamento *</label>
                        <input type="text" id="inputTombamento" required 
                               placeholder="000000123456" maxlength="12">
                    </div>
                    
                    <div class="form-group">
                        <label>Data Aquisi√ß√£o *</label>
                        <input type="date" id="inputDataAquisicao" required>
                    </div>
                    
                    <div class="form-group full-width">
                        <label>Descri√ß√£o *</label>
                        <input type="text" id="inputDescricao" required 
                               placeholder="Ex: Computador All In One">
                    </div>
                    
                    <div class="form-group">
                        <label>Categoria *</label>
                        <select id="inputCategoria" required>
                            <option value="">Selecione...</option>
                            <option value="Equipamento TI">Equipamento TI</option>
                            <option value="Ve√≠culos">Ve√≠culos</option>
                            <option value="Mobili√°rio">Mobili√°rio</option>
                            <option value="Equipamentos M√©dicos">Equipamentos M√©dicos</option>
                            <option value="Eletrodom√©sticos">Eletrodom√©sticos</option>
                            <option value="Comunica√ß√£o">Comunica√ß√£o</option>
                            <option value="Audiovisual">Audiovisual</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label>Situa√ß√£o *</label>
                        <select id="inputSituacao" required>
                            <option value="Ativo">Ativo</option>
                            <option value="Manuten√ß√£o">Manuten√ß√£o</option>
                            <option value="Inativo">Inativo</option>
                        </select>
                    </div>
                    
                    <div class="form-group full-width">
                        <label>Setor *</label>
                        <input type="text" id="inputSetor" required 
                               placeholder="Ex: SEC MEIO AMBIENTE">
                    </div>
                    
                    <div class="form-group">
                        <label>Respons√°vel *</label>
                        <input type="text" id="inputResponsavel" required 
                               placeholder="Ex: Servidor Administrativo">
                    </div>
                    
                    <div class="form-group">
                        <label>Localiza√ß√£o *</label>
                        <input type="text" id="inputLocalizacao" required 
                               placeholder="Ex: Sala 201">
                    </div>
                    
                    <div class="form-group full-width">
                        <label>Observa√ß√µes</label>
                        <textarea id="inputObservacoes" rows="3" 
                                  placeholder="Informa√ß√µes adicionais..."></textarea>
                    </div>
                </div>
                
                <div class="modal-footer">
                    <button type="button" class="btn-secondary" onclick="fecharModal()">Cancelar</button>
                    <button type="submit" class="btn-primary">Salvar Patrim√¥nio</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Confirma√ß√£o de Exclus√£o -->
    <div id="modalConfirmar" class="modal">
        <div class="modal-content modal-small">
            <div class="modal-header">
                <h2>‚ö†Ô∏è Confirmar Exclus√£o</h2>
                <span class="close" onclick="fecharModalConfirmar()">&times;</span>
            </div>
            <div class="modal-body">
                <p>Deseja realmente excluir este patrim√¥nio?</p>
                <p><strong id="itemExcluir"></strong></p>
                <p class="warning-text">Esta a√ß√£o n√£o pode ser desfeita!</p>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" onclick="fecharModalConfirmar()">Cancelar</button>
                <button class="btn-danger" onclick="confirmarExclusao()">Sim, Excluir</button>
            </div>
        </div>
    </div>
    
    <script src="dados/patrimonio.js"></script>
    <script src="js/funcoes.js"></script>
</body>
</html>
